<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جولة الميدانية في المدارس</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- مكتبات لتصدير Excel و Word و PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.6.0/html-docx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery/3.6.0/jquery.min.js"></script>
    
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            margin: 0;
            background-color: #f5f5f5;
            padding: 10px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        .navbar {
            background-color: #309ca0;
            display: flex;
            justify-content: center;
            padding: 10px 0;
        }
        .navbar a {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            font-size: 16px;
        }
        .navbar a:hover {
            background-color: #ddd;
            color: black;
        }
        .section-title {
            text-align: center;
            padding: 20px;
            background-color: #309ca0;
            color: white;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
        }
        .table-container {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            text-align: center;
        }
        th, td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        th {
            background-color: #309ca0;
            color: white;
        }
        footer {
            background-color: #309ca0;
            color: white;
            text-align: center;
            padding: 10px 0;
            font-size: 14px;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            background-color: #309ca0;
            color: white;
            border: none;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #007b7b;
        }
        input[type="number"] {
            width: 50px;
            padding: 5px;
            text-align: center;
        }
        .school-name {
            width: 200px;
            padding: 5px;
            text-align: center;
            margin: 10px 0;
        }
        .share-btn {
            background-color: #25D366;
            padding: 10px;
            color: white;
            font-size: 16px;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <a href="ii.html">الرئيسية</a>
        <a href="bb.html">عنّي</a>
        <a href="rr.html">اتصل بي</a>
    </div>
    <div class="section-title">
        <h1>جولة الميدانية في المدارس</h1>
    </div>
    <div class="container">
        <label for="schoolName">اسم المدرسة:</label>
        <input type="text" id="schoolName" class="school-name" placeholder="أدخل اسم المدرسة">

        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>المكونات</th>
                        <th>العدد</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>الفصول الدراسية</td>
                        <td><input type="number" id="classrooms" value="0"></td>
                    </tr>
                    <tr>
                        <td>الملاعب</td>
                        <td><input type="number" id="playgrounds" value="0"></td>
                    </tr>
                    <tr>
                        <td>المضلات الخارجية</td>
                        <td><input type="number" id="shades" value="0"></td>
                    </tr>
                    <tr>
                        <td>الحمامات</td>
                        <td><input type="number" id="bathrooms" value="0"></td>
                    </tr>
                    <tr>
                        <td>دورات المياه</td>
                        <td><input type="number" id="toilets" value="0"></td>
                    </tr>
                    <tr>
                        <td>غرف العيادات</td>
                        <td><input type="number" id="clinics" value="0"></td>
                    </tr>
                    <tr>
                        <td>معامل الحاسب</td>
                        <td><input type="number" id="computers" value="0"></td>
                    </tr>
                    <tr>
                        <td>المقاصف</td>
                        <td><input type="number" id="canteens" value="0"></td>
                    </tr>
                    <tr>
                        <td>الأدوار</td>
                        <td><input type="number" id="floors" value="0"></td>
                    </tr>
                    <tr>
                        <td>مكاتب ادارية</td>
                        <td><input type="number" id="offices" value="0"></td>
                    </tr>
                    <tr>
                        <td>معامل العلوم</td>
                        <td><input type="number" id="scienceLabs" value="0"></td>
                    </tr>
                    <!-- أصول الكهرباء -->
                    <tr>
                        <td>الإضاءة الخارجية الأعمدة</td>
                        <td><input type="number" id="outdoorLights" value="0"></td>
                    </tr>
                    <tr>
                        <td>الطابعات</td>
                        <td><input type="number" id="printers" value="0"></td>
                    </tr>
                    <tr>
                        <td>الشاشات</td>
                        <td><input type="number" id="screens" value="0"></td>
                    </tr>
                    <tr>
                        <td>كاميرات المراقبة</td>
                        <td><input type="number" id="cameras" value="0"></td>
                    </tr>
                    <tr>
                        <td>مفتاح الكهرباء</td>
                        <td><input type="number" id="electricSwitch" value="0"></td>
                    </tr>
                    <tr>
                        <td>البروجكتر</td>
                        <td><input type="number" id="projector" value="0"></td>
                    </tr>
                    <tr>
                        <td>أفياش الكهرباء</td>
                        <td><input type="number" id="electricSockets" value="0"></td>
                    </tr>
                    <tr>
                        <td>مكيف شباك</td>
                        <td><input type="number" id="windowAC" value="0"></td>
                    </tr>
                    <tr>
                        <td>مكيفات سبليت</td>
                        <td><input type="number" id="splitAC" value="0"></td>
                    </tr>
                    <tr>
                        <td>الكمبيوترات المكتبية</td>
                        <td><input type="number" id="desktopComputers" value="0"></td>
                    </tr>
                    <tr>
                        <td>السبورات التعليمية</td>
                        <td><input type="number" id="smartBoards" value="0"></td>
                    </tr>
                    <!-- أصول الأدوات الصحية -->
                    <tr>
                        <td>السخانات الكهربائية</td>
                        <td><input type="number" id="electricHeaters" value="0"></td>
                    </tr>
                    <tr>
                        <td>الخزانات الخرسانية</td>
                        <td><input type="number" id="concreteTanks" value="0"></td>
                    </tr>
                    <tr>
                        <td>خزانات PVC</td>
                        <td><input type="number" id="PVC_Tanks" value="0"></td>
                    </tr>
                    <tr>
                        <td>فتح تصريف المياه الأسطح</td>
                        <td><input type="number" id="waterDrains" value="0"></td>
                    </tr>
                    <tr>
                        <td>برادات شرب المياه</td>
                        <td><input type="number" id="waterCoolers" value="0"></td>
                    </tr>
                    <tr>
                        <td>مواطير المياه</td>
                        <td><input type="number" id="waterMotors" value="0"></td>
                    </tr>
                    <tr>
                        <td>مرواح الشفط</td>
                        <td><input type="number" id="exhaustFans" value="0"></td>
                    </tr>
                    <!-- أصول الصحة والسلامة -->
                    <tr>
                        <td>مخارج الطوارئ</td>
                        <td><input type="number" id="emergencyExits" value="0"></td>
                    </tr>
                    <tr>
                        <td>مضخات نظام الإطفاء</td>
                        <td><input type="number" id="firePump" value="0"></td>
                    </tr>
                    <tr>
                        <td>طفايات الحريق</td>
                        <td><input type="number" id="fireExtinguishers" value="0"></td>
                    </tr>
                    <tr>
                        <td>كشافات الحريق والدخان</td>
                        <td><input type="number" id="fireSmokeLights" value="0"></td>
                    </tr>
                    <tr>
                        <td>رشاشات ماء الإطفاء</td>
                        <td><input type="number" id="fireSprinklers" value="0"></td>
                    </tr>
                    <tr>
                        <td>جرس الإنذار</td>
                        <td><input type="number" id="alarmBell" value="0"></td>
                    </tr>
                    <tr>
                        <td>لوحات مخارج الطوارئ</td>
                        <td><input type="number" id="emergencyExitSigns" value="0"></td>
                    </tr>
                    <tr>
                        <td>صناديق خراطيم الإطفاء</td>
                        <td><input type="number" id="fireHoseBoxes" value="0"></td>
                    </tr>
                    <tr>
                        <td>لوحات أنظمة الحريق</td>
                        <td><input type="number" id="fireSystemSigns" value="0"></td>
                    </tr>
                    <tr>
                        <td>مضخات إطفاء حكومية خارجية</td>
                        <td><input type="number" id="govFirePumps" value="0"></td>
                    </tr>
                    <tr>
                        <td>لوحات تجمع</td>
                        <td><input type="number" id="gatheringSigns" value="0"></td>
                    </tr>
                    <tr>
                        <td>حواجز سلامة</td>
                        <td><input type="number" id="safetyBarriers" value="0"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <button onclick="exportToExcel()">تصدير إلى Excel</button>
        <button onclick="exportToWord()">تصدير إلى Word</button>
        <button onclick="exportToPDF()">تصدير إلى PDF</button>

        <button onclick="shareWhatsApp()">مشاركة عبر WhatsApp</button>

    </div>

    <footer>
        <p>© 2024 المدرسة</p>
    </footer>

    <script>
        function exportToExcel() {
            var table = document.getElementById("dataTable");
            var wb = XLSX.utils.table_to_book(table);
            XLSX.write(wb, {bookType: 'xlsx', bookSST: true, type: 'binary'});
            saveAs(new Blob([s2ab(wb)], {type: "application/octet-stream"}), "data.xlsx");
        }

        function exportToWord() {
            var table = document.getElementById("dataTable");
            var html = table.outerHTML;
            var converted = htmlDocx.asBlob(html);
            saveAs(converted, "data.docx");
        }

        function exportToPDF() {
            var doc = new jsPDF();
            doc.html(document.body, {
                callback: function (doc) {
                    doc.save('data.pdf');
                },
                x: 10,
                y: 10
            });
        }

        function s2ab(s) {
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }

        function shareWhatsApp() {
            var schoolName = document.getElementById("schoolName").value;
            var message = `تم تجهيز بيانات المدرسة: ${schoolName} بنجاح.`;
            var url = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>