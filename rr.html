<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بيانات المدرسة</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>بيانات المدرسة</h1>
        <form id="schoolForm">
            <label for="schoolName">اسم المدرسة:</label>
            <input type="text" id="schoolName" name="schoolName" required><br><br>

            <h2>مكونات المبنى:</h2>
            <label for="classrooms">الفصول الدراسية:</label>
            <input type="number" id="classrooms" value="0"><br><br>
            <label for="playgrounds">الملاعب:</label>
            <input type="number" id="playgrounds" value="0"><br><br>
            <label for="shade">المضلات الخارجية:</label>
            <input type="number" id="shade" value="0"><br><br>
            <label for="bathrooms">الحمامات:</label>
            <input type="number" id="bathrooms" value="0"><br><br>
            <label for="labs">غرف العيادات:</label>
            <input type="number" id="labs" value="0"><br><br>
            <label for="computerLabs">معامل الحاسب:</label>
            <input type="number" id="computerLabs" value="0"><br><br>

            <!-- Additional sections for each category -->
            
            <h2>إرسال بيانات المدرسة عبر واتساب</h2>
            <a id="whatsappLink" href="javascript:void(0);" target="_blank">أرسل عبر واتساب</a><br><br>

            <button type="button" id="savePdf">تصدير إلى PDF</button>
            <button type="button" id="saveWord">تصدير إلى Word</button>
        </form>
    </div>

    <script>
        // Handle WhatsApp link formatting
        function updateWhatsAppLink() {
            var schoolName = document.getElementById('schoolName').value;
            var classrooms = document.getElementById('classrooms').value;
            var playgrounds = document.getElementById('playgrounds').value;
            var shade = document.getElementById('shade').value;
            var bathrooms = document.getElementById('bathrooms').value;
            var labs = document.getElementById('labs').value;
            var computerLabs = document.getElementById('computerLabs').value;

            var message = `
            بيانات المدرسة: ${schoolName}
            الفصول الدراسية: ${classrooms}
            الملاعب: ${playgrounds}
            المضلات الخارجية: ${shade}
            الحمامات: ${bathrooms}
            غرف العيادات: ${labs}
            معامل الحاسب: ${computerLabs}
            `;
            var whatsappLink = `https://wa.me/?text=${encodeURIComponent(message)}`;
            document.getElementById('whatsappLink').href = whatsappLink;
        }

        // Update the WhatsApp link when the user changes data
        document.getElementById('schoolName').addEventListener('input', updateWhatsAppLink);
        document.getElementById('classrooms').addEventListener('input', updateWhatsAppLink);
        document.getElementById('playgrounds').addEventListener('input', updateWhatsAppLink);
        document.getElementById('shade').addEventListener('input', updateWhatsAppLink);
        document.getElementById('bathrooms').addEventListener('input', updateWhatsAppLink);
        document.getElementById('labs').addEventListener('input', updateWhatsAppLink);
        document.getElementById('computerLabs').addEventListener('input', updateWhatsAppLink);

        // Export to PDF
        document.getElementById('savePdf').addEventListener('click', function () {
            var element = document.body; // Or you can use a specific container
            html2pdf(element);
        });

        // Export to Word
        document.getElementById('saveWord').addEventListener('click', function () {
            var schoolData = {
                schoolName: document.getElementById('schoolName').value,
                classrooms: document.getElementById('classrooms').value,
                playgrounds: document.getElementById('playgrounds').value,
                shade: document.getElementById('shade').value,
                bathrooms: document.getElementById('bathrooms').value,
                labs: document.getElementById('labs').value,
                computerLabs: document.getElementById('computerLabs').value,
            };

            var doc = new window.jspdf.jsPDF();
            doc.text("بيانات المدرسة:", 10, 10);
            doc.text("اسم المدرسة: " + schoolData.schoolName, 10, 20);
            doc.text("الفصول الدراسية: " + schoolData.classrooms, 10, 30);
            doc.text("الملاعب: " + schoolData.playgrounds, 10, 40);
            doc.text("المضلات الخارجية: " + schoolData.shade, 10, 50);
            doc.text("الحمامات: " + schoolData.bathrooms, 10, 60);
            doc.text("غرف العيادات: " + schoolData.labs, 10, 70);
            doc.text("معامل الحاسب: " + schoolData.computerLabs, 10, 80);

            doc.save("بيانات_المدرسة.pdf");
        });
    </script>
</body>
</html>