<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جولة الميدانية في المدارس</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- مكتبات لتصدير Excel و Word و PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.6.0/html-docx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery/3.6.0/jquery.min.js"></script>
    
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            margin: 0;
            background-color: #f5f5f5;
            padding: 10px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        .navbar {
            background-color: #309ca0;
            display: flex;
            justify-content: center;
            padding: 10px 0;
        }
        .navbar a {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            font-size: 16px;
        }
        .navbar a:hover {
            background-color: #ddd;
            color: black;
        }
        .section-title {
            text-align: center;
            padding: 20px;
            background-color: #309ca0;
            color: white;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
        }
        .table-container {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            text-align: center;
        }
        th, td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        th {
            background-color: #309ca0;
            color: white;
        }
        footer {
            background-color: #309ca0;
            color: white;
            text-align: center;
            padding: 10px 0;
            font-size: 14px;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            background-color: #309ca0;
            color: white;
            border: none;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #007b7b;
        }
        input[type="number"] {
            width: 50px;
            padding: 5px;
            text-align: center;
        }
        .school-name {
            width: 200px;
            padding: 5px;
            text-align: center;
            margin: 10px 0;
        }
        .share-btn {
            background-color: #25D366;
            padding: 10px;
            color: white;
            font-size: 16px;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <a href="ii.html">الرئيسية</a>
        <a href="bb.html">عنّي</a>
        <a href="rr.html">اتصل بي</a>
    </div>
    <div class="section-title">
        <h1>جولة الميدانية في المدارس</h1>
    </div>
    <div class="container">
        <label for="schoolName">اسم المدرسة:</label>
        <input type="text" id="schoolName" class="school-name" placeholder="أدخل اسم المدرسة">

        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>المكونات</th>
                        <th>العدد</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- البيانات مكررة لجميع الحقول كما في الجدول السابق -->
                    <tr>
                        <td>الفصول الدراسية</td>
                        <td><input type="number" id="classrooms" value="0"></td>
                    </tr>
                    <tr>
                        <td>الملاعب</td>
                        <td><input type="number" id="playgrounds" value="0"></td>
                    </tr>
                    <tr>
                        <td>المضلات الخارجية</td>
                        <td><input type="number" id="shades" value="0"></td>
                    </tr>
                    <tr>
                        <td>الحمامات</td>
                        <td><input type="number" id="bathrooms" value="0"></td>
                    </tr>
                    <!-- أضف باقي الحقول هنا بالطريقة نفسها -->
                </tbody>
            </table>
        </div>
        <button onclick="submitData()">إرسال البيانات</button>
        <button onclick="exportToExcel()">تصدير إلى Excel</button>
        <button onclick="exportToWord()">تصدير إلى Word</button>
        <button onclick="exportToPDF()">تصدير إلى PDF</button>
        <button class="share-btn" onclick="shareWhatsApp()">مشاركة عبر WhatsApp</button>
    </div>
    <footer>
        <p>© 2024 مدرسة</p>
    </footer>

    <script>
        function submitData() {
            const schoolName = document.getElementById('schoolName').value;
            alert(`تم إرسال بيانات المدرسة: ${schoolName}`);
            shareWhatsApp();  // إرسال البيانات مباشرة عبر الواتس
        }

        function exportToExcel() {
            const ws = XLSX.utils.table_to_sheet(document.getElementById('dataTable'));
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "جولة الميدانية");
            XLSX.writeFile(wb, "جولة الميدانية.xlsx");
        }

        function exportToWord() {
            const htmlContent = document.getElementById('dataTable').outerHTML;
            const converted = htmlDocx.asBlob(htmlContent);
            saveAs(converted, "جولة الميدانية.docx");
        }

        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.autoTable({ html: '#dataTable' });
            doc.save('جولة الميدانية.pdf');
        }

        function shareWhatsApp() {
            const schoolName = document.getElementById('schoolName').value;
            const tableData = getTableData();
            const message = `اسم المدرسة: ${schoolName}\n\n${tableData}`;
            const phoneNumber = '0565464718'; // رقم المشرف
            const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        function getTableData() {
            let data = '';
            const rows = document.querySelectorAll('#dataTable tbody tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                data += `${cells[0].textContent}: ${cells[1].querySelector('input').value}\n`;
            });
            return data;
        }
    </script>
</body>
</html>